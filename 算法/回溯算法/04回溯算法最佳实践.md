# 04 å›æº¯ç®—æ³•è§£å†³æ•°ç‹¬

|                            ç‰›å®¢ç½‘                            |                           LeetCode                           |                             åŠ›æ‰£                             | éš¾åº¦ |
| :----------------------------------------------------------: | :----------------------------------------------------------: | :----------------------------------------------------------: | :--: |
| [è§£æ•°ç‹¬](https://www.nowcoder.com/practice/5e6c424b82224b85b64f28fd85761280?tpId=295&fromPut=pc_wzcpa_labuladong_sf) | [37. Sudoku Solver](https://leetcode.com/problems/sudoku-solver) | [37. è§£æ•°ç‹¬](https://leetcode-cn.com/problems/sudoku-solver) |  ğŸ”´   |
| [æ‹¬å·ç”Ÿæˆ](https://www.nowcoder.com/practice/c9addb265cdf4cdd92c092c655d164ca?tpId=295&fromPut=pc_wzcpa_labuladong_sf) | [22. Generate Parentheses](https://leetcode.com/problems/generate-parentheses) | [22. æ‹¬å·ç”Ÿæˆ](https://leetcode-cn.com/problems/generate-parentheses) |  ğŸŸ    |

## 4.1 è§£æ•°ç‹¬

è¾“å…¥æ˜¯ä¸€ä¸ª9x9çš„æ£‹ç›˜ï¼Œç©ºç™½æ ¼å­ç”¨ç‚¹å·å­—ç¬¦ `.` è¡¨ç¤ºï¼Œç®—æ³•éœ€è¦åœ¨åŸåœ°ä¿®æ”¹æ£‹ç›˜ï¼Œå°†ç©ºç™½æ ¼å­å¡«ä¸Šæ•°å­—ï¼Œå¾—åˆ°ä¸€ä¸ªå¯è¡Œè§£ã€‚

è‡³äºæ•°ç‹¬çš„è¦æ±‚ï¼Œå¤§å®¶æƒ³å¿…éƒ½å¾ˆç†Ÿæ‚‰äº†ï¼Œæ¯è¡Œï¼Œæ¯åˆ—ä»¥åŠæ¯ä¸€ä¸ª 3Ã—3 çš„å°æ–¹æ ¼éƒ½ä¸èƒ½æœ‰ç›¸åŒçš„æ•°å­—å‡ºç°ã€‚

**ç®—æ³•çš„æ ¸å¿ƒæ€è·¯éå¸¸éå¸¸çš„ç®€å•ï¼Œå°±æ˜¯å¯¹æ¯ä¸€ä¸ªç©ºç€çš„æ ¼å­ç©·ä¸¾ 1 åˆ° 9ï¼Œå¦‚æœé‡åˆ°ä¸åˆæ³•çš„æ•°å­—ï¼ˆåœ¨åŒä¸€è¡Œæˆ–åŒä¸€åˆ—æˆ–åŒä¸€ä¸ª 3Ã—3 çš„åŒºåŸŸä¸­å­˜åœ¨ç›¸åŒçš„æ•°å­—ï¼‰åˆ™è·³è¿‡ï¼Œå¦‚æœæ‰¾åˆ°ä¸€ä¸ªåˆæ³•çš„æ•°å­—ï¼Œåˆ™ç»§ç»­ç©·ä¸¾ä¸‹ä¸€ä¸ªç©ºæ ¼å­**ã€‚

```java
// å¯¹ board[i][j] è¿›è¡Œç©·ä¸¾å°è¯•
void backtrack(char[][] board, int i, int j) {
    int m = 9, n = 9;
    for (char ch = '1'; ch <= '9'; ch++) {
        // åšé€‰æ‹©
        board[i][j] = ch;
        // ç»§ç»­ç©·ä¸¾ä¸‹ä¸€ä¸ª
        backtrack(board, i, j + 1);
        // æ’¤é”€é€‰æ‹©
        board[i][j] = '.';
    }
}
```

ç»§ç»­ç»†åŒ–ï¼Œå¹¶ä¸æ˜¯ 1 åˆ° 9 éƒ½å¯ä»¥å–åˆ°çš„ï¼Œæœ‰çš„æ•°å­—ä¸æ˜¯ä¸æ»¡è¶³æ•°ç‹¬çš„åˆæ³•æ¡ä»¶å—ï¼Ÿè€Œä¸”ç°åœ¨åªæ˜¯ç»™ `j` åŠ ä¸€ï¼Œé‚£å¦‚æœ `j` åŠ åˆ°æœ€åä¸€åˆ—äº†ï¼Œæ€ä¹ˆåŠï¼Ÿ

**å¾ˆç®€å•ï¼Œå½“ `j` åˆ°è¾¾è¶…è¿‡æ¯ä¸€è¡Œçš„æœ€åä¸€ä¸ªç´¢å¼•æ—¶ï¼Œè½¬ä¸ºå¢åŠ  `i` å¼€å§‹ç©·ä¸¾ä¸‹ä¸€è¡Œï¼Œå¹¶ä¸”åœ¨ç©·ä¸¾ä¹‹å‰æ·»åŠ ä¸€ä¸ªåˆ¤æ–­ï¼Œè·³è¿‡ä¸æ»¡è¶³æ¡ä»¶çš„æ•°å­—**ï¼š

```java
void backtrack(char[][] board, int i, int j) {
    int m = 9, n = 9;
    if (j == n) {
        // ç©·ä¸¾åˆ°æœ€åä¸€åˆ—çš„è¯å°±æ¢åˆ°ä¸‹ä¸€è¡Œé‡æ–°å¼€å§‹ã€‚
        backtrack(board, i + 1, 0);
        return;
    }
    
    // å¦‚æœè¯¥ä½ç½®æ˜¯é¢„è®¾çš„æ•°å­—ï¼Œä¸ç”¨æˆ‘ä»¬æ“å¿ƒ
    if (board[i][j] != '.') {
        backtrack(board, i, j + 1);
        return;
    } 

    for (char ch = '1'; ch <= '9'; ch++) {
        // å¦‚æœé‡åˆ°ä¸åˆæ³•çš„æ•°å­—ï¼Œå°±è·³è¿‡
        if (!isValid(board, i, j, ch))
            continue;
        
        board[i][j] = ch;
        backtrack(board, i, j + 1);
        board[i][j] = '.';
    }
}

// åˆ¤æ–­ board[i][j] æ˜¯å¦å¯ä»¥å¡«å…¥ n
boolean isValid(char[][] board, int r, int c, char n) {
    for (int i = 0; i < 9; i++) {
        // åˆ¤æ–­è¡Œæ˜¯å¦å­˜åœ¨é‡å¤
        if (board[r][i] == n) return false;
        // åˆ¤æ–­åˆ—æ˜¯å¦å­˜åœ¨é‡å¤
        if (board[i][c] == n) return false;
        // åˆ¤æ–­ 3 x 3 æ–¹æ¡†æ˜¯å¦å­˜åœ¨é‡å¤
        if (board[(r/3)*3 + i/3][(c/3)*3 + i%3] == n)
            return false;
    }
    return true;
}
```

è¿˜å‰©æœ€åä¸€ä¸ªé—®é¢˜ï¼šè¿™ä¸ªç®—æ³•æ²¡æœ‰ base caseï¼Œæ°¸è¿œä¸ä¼šåœæ­¢é€’å½’ã€‚è¿™ä¸ªå¥½åŠï¼Œä»€ä¹ˆæ—¶å€™ç»“æŸé€’å½’ï¼Ÿ**æ˜¾ç„¶ `r == m` çš„æ—¶å€™å°±è¯´æ˜ç©·ä¸¾å®Œäº†æœ€åä¸€è¡Œï¼Œå®Œæˆäº†æ‰€æœ‰çš„ç©·ä¸¾ï¼Œå°±æ˜¯ base case**ã€‚

å¦å¤–ï¼Œå‰æ–‡ä¹Ÿæåˆ°è¿‡ï¼Œä¸ºäº†å‡å°‘å¤æ‚åº¦ï¼Œæˆ‘ä»¬å¯ä»¥è®© `backtrack` å‡½æ•°è¿”å›å€¼ä¸º `boolean`ï¼Œå¦‚æœæ‰¾åˆ°ä¸€ä¸ªå¯è¡Œè§£å°±è¿”å› trueï¼Œè¿™æ ·å°±å¯ä»¥é˜»æ­¢åç»­çš„é€’å½’ã€‚åªæ‰¾ä¸€ä¸ªå¯è¡Œè§£ï¼Œä¹Ÿæ˜¯é¢˜ç›®çš„æœ¬æ„ã€‚

æœ€ç»ˆä»£ç ä¿®æ”¹å¦‚ä¸‹ï¼š

```java
boolean backtrack(char[][] board, int i, int j) {
    int m = 9, n = 9;
    if (j == n) {
        // ç©·ä¸¾åˆ°æœ€åä¸€åˆ—çš„è¯å°±æ¢åˆ°ä¸‹ä¸€è¡Œé‡æ–°å¼€å§‹ã€‚
        return backtrack(board, i + 1, 0);
    }
    if (i == m) {
        // æ‰¾åˆ°ä¸€ä¸ªå¯è¡Œè§£ï¼Œè§¦å‘ base case
        return true;
    }

    if (board[i][j] != '.') {
        // å¦‚æœæœ‰é¢„è®¾æ•°å­—ï¼Œä¸ç”¨æˆ‘ä»¬ç©·ä¸¾
        return backtrack(board, i, j + 1);
    } 

    for (char ch = '1'; ch <= '9'; ch++) {
        // å¦‚æœé‡åˆ°ä¸åˆæ³•çš„æ•°å­—ï¼Œå°±è·³è¿‡
        if (!isValid(board, i, j, ch))
            continue;
        
        board[i][j] = ch;
        // å¦‚æœæ‰¾åˆ°ä¸€ä¸ªå¯è¡Œè§£ï¼Œç«‹å³ç»“æŸ
        if (backtrack(board, i, j + 1)) {
            return true;
        }
        board[i][j] = '.';
    }
    // ç©·ä¸¾å®Œ 1~9ï¼Œä¾ç„¶æ²¡æœ‰æ‰¾åˆ°å¯è¡Œè§£ï¼Œæ­¤è·¯ä¸é€š
    return false;
}

boolean isValid(char[][] board, int r, int c, char n) {
    // è§ä¸Šæ–‡
}
```

## 4.2 æ‹¬å·ç”Ÿæˆ

çœ‹ä¸‹åŠ›æ‰£ç¬¬ 22 é¢˜ã€Œ [æ‹¬å·ç”Ÿæˆ](https://leetcode-cn.com/problems/generate-parentheses)ã€ï¼Œè¦æ±‚å¦‚ä¸‹ï¼š

è¯·ä½ å†™ä¸€ä¸ªç®—æ³•ï¼Œè¾“å…¥æ˜¯ä¸€ä¸ªæ­£æ•´æ•° `n`ï¼Œè¾“å‡ºæ˜¯ `n` å¯¹å„¿æ‹¬å·çš„æ‰€æœ‰åˆæ³•ç»„åˆã€‚

æœ‰å…³æ‹¬å·é—®é¢˜ï¼Œä½ åªè¦è®°ä½ä»¥ä¸‹æ€§è´¨ï¼Œæ€è·¯å°±å¾ˆå®¹æ˜“æƒ³å‡ºæ¥ï¼š

**1ã€ä¸€ä¸ªã€Œåˆæ³•ã€æ‹¬å·ç»„åˆçš„å·¦æ‹¬å·æ•°é‡ä¸€å®šç­‰äºå³æ‹¬å·æ•°é‡ï¼Œè¿™ä¸ªå¾ˆå¥½ç†è§£**ã€‚

**2ã€å¯¹äºä¸€ä¸ªã€Œåˆæ³•ã€çš„æ‹¬å·å­—ç¬¦ä¸²ç»„åˆ `p`ï¼Œå¿…ç„¶å¯¹äºä»»ä½• `0 <= i < len(p)` éƒ½æœ‰ï¼šå­ä¸² `p[0..i]` ä¸­å·¦æ‹¬å·çš„æ•°é‡éƒ½å¤§äºæˆ–ç­‰äºå³æ‹¬å·çš„æ•°é‡**ã€‚

å¦‚æœä¸è·Ÿä½ è¯´è¿™ä¸ªæ€§è´¨ï¼Œå¯èƒ½ä¸å¤ªå®¹æ˜“å‘ç°ï¼Œä½†æ˜¯ç¨å¾®æƒ³ä¸€ä¸‹ï¼Œå…¶å®å¾ˆå®¹æ˜“ç†è§£ï¼Œå› ä¸ºä»å·¦å¾€å³ç®—çš„è¯ï¼Œè‚¯å®šæ˜¯å·¦æ‹¬å·å¤šå˜›ï¼Œåˆ°æœ€åå·¦å³æ‹¬å·æ•°é‡ç›¸ç­‰ï¼Œè¯´æ˜è¿™ä¸ªæ‹¬å·ç»„åˆæ˜¯åˆæ³•çš„ã€‚

åä¹‹ï¼Œæ¯”å¦‚è¿™ä¸ªæ‹¬å·ç»„åˆ `))((`ï¼Œå‰å‡ ä¸ªå­ä¸²éƒ½æ˜¯å³æ‹¬å·å¤šäºå·¦æ‹¬å·ï¼Œæ˜¾ç„¶ä¸æ˜¯åˆæ³•çš„æ‹¬å·ç»„åˆã€‚

**å›æº¯æ€è·¯**

æ˜ç™½äº†åˆæ³•æ‹¬å·çš„æ€§è´¨ï¼Œå¦‚ä½•æŠŠè¿™é“é¢˜å’Œå›æº¯ç®—æ³•æ‰¯ä¸Šå…³ç³»å‘¢ï¼Ÿ

ç®—æ³•è¾“å…¥ä¸€ä¸ªæ•´æ•° `n`ï¼Œè®©ä½ è®¡ç®— **`n` å¯¹æ‹¬å·**èƒ½ç»„æˆå‡ ç§åˆæ³•çš„æ‹¬å·ç»„åˆï¼Œå¯ä»¥æ”¹å†™æˆå¦‚ä¸‹é—®é¢˜ï¼š

**ç°åœ¨æœ‰ `2n` ä¸ªä½ç½®ï¼Œæ¯ä¸ªä½ç½®å¯ä»¥æ”¾ç½®å­—ç¬¦ `(` æˆ–è€… `)`ï¼Œç»„æˆçš„æ‰€æœ‰æ‹¬å·ç»„åˆä¸­ï¼Œæœ‰å¤šå°‘ä¸ªæ˜¯åˆæ³•çš„**ï¼Ÿ

```java
class Solution {

    List<String> res = new LinkedList(); 
    StringBuilder track = new StringBuilder();

    public List<String> generateParenthesis(int n) {
        backtrack(track, 0, 0, n);
        return res;
    }

    void backtrack(StringBuilder track, int left, int right, int n){
        // base case
        if(left < right || left>n || right>n) return;
        if(left==right && left+right==2*n){
            res.add(track.toString());
            return;
        }
        track.append('(');
        backtrack(track, left+1, right, n);
        track.deleteCharAt(track.length() - 1);

        track.append(')');
        backtrack(track, left, right+1, n);
        track.deleteCharAt(track.length() - 1);
    }
}
```

è¿™ä¸ªæ¯”è¾ƒéš¾åˆ†æï¼Œ**å¯¹äºé€’å½’ç›¸å…³çš„ç®—æ³•ï¼Œæ—¶é—´å¤æ‚åº¦è¿™æ ·è®¡ç®—ï¼ˆé€’å½’æ¬¡æ•°ï¼‰\*ï¼ˆé€’å½’å‡½æ•°æœ¬èº«çš„æ—¶é—´å¤æ‚åº¦ï¼‰**ã€‚

`backtrack` å°±æ˜¯æˆ‘ä»¬çš„é€’å½’å‡½æ•°ï¼Œå…¶ä¸­æ²¡æœ‰ä»»ä½• for å¾ªç¯ä»£ç ï¼Œæ‰€ä»¥é€’å½’å‡½æ•°æœ¬èº«çš„æ—¶é—´å¤æ‚åº¦æ˜¯ O(1)ï¼Œä½†å…³é”®æ˜¯è¿™ä¸ªå‡½æ•°çš„é€’å½’æ¬¡æ•°æ˜¯å¤šå°‘ï¼Ÿæ¢å¥è¯è¯´ï¼Œç»™å®šä¸€ä¸ª `n`ï¼Œ`backtrack` å‡½æ•°é€’å½’è¢«è°ƒç”¨äº†å¤šå°‘æ¬¡ï¼Ÿ

æˆ‘ä»¬å‰é¢æ€ä¹ˆåˆ†æåŠ¨æ€è§„åˆ’ç®—æ³•çš„é€’å½’æ¬¡æ•°çš„ï¼Ÿä¸»è¦æ˜¯çœ‹ã€ŒçŠ¶æ€ã€çš„ä¸ªæ•°å¯¹å§ã€‚å…¶å®å›æº¯ç®—æ³•å’ŒåŠ¨æ€è§„åˆ’çš„æœ¬è´¨éƒ½æ˜¯ç©·ä¸¾ï¼Œåªä¸è¿‡åŠ¨æ€è§„åˆ’å­˜åœ¨ã€Œé‡å å­é—®é¢˜ã€å¯ä»¥ä¼˜åŒ–ï¼Œè€Œå›æº¯ç®—æ³•ä¸å­˜åœ¨è€Œå·²ã€‚

æ‰€ä»¥è¯´è¿™é‡Œä¹Ÿå¯ä»¥ç”¨ã€ŒçŠ¶æ€ã€è¿™ä¸ªæ¦‚å¿µï¼Œ**å¯¹äº `backtrack` å‡½æ•°ï¼ŒçŠ¶æ€æœ‰ä¸‰ä¸ªï¼Œåˆ†åˆ«æ˜¯ `left, right, track`**ï¼Œè¿™ä¸‰ä¸ªå˜é‡çš„æ‰€æœ‰ç»„åˆä¸ªæ•°å°±æ˜¯ `backtrack` å‡½æ•°çš„çŠ¶æ€ä¸ªæ•°ï¼ˆè°ƒç”¨æ¬¡æ•°ï¼‰ã€‚

`left` å’Œ `right` çš„ç»„åˆå¥½åŠï¼Œä»–ä¿©å–å€¼å°±æ˜¯ 0~n å˜›ï¼Œç»„åˆèµ·æ¥ä¹Ÿå°± `n^2` ç§è€Œå·²ï¼›è¿™ä¸ª `track` çš„é•¿åº¦è™½ç„¶å–åœ¨ 0~2nï¼Œä½†å¯¹äºæ¯ä¸€ä¸ªé•¿åº¦ï¼Œå®ƒè¿˜æœ‰æŒ‡æ•°çº§çš„æ‹¬å·ç»„åˆï¼Œè¿™ä¸ªæ˜¯ä¸å¥½ç®—çš„ã€‚

è¯´äº†è¿™ä¹ˆå¤šï¼Œå°±æ˜¯æƒ³è®©å¤§å®¶çŸ¥é“è¿™ä¸ªç®—æ³•çš„å¤æ‚åº¦æ˜¯æŒ‡æ•°çº§ï¼Œè€Œä¸”ä¸å¥½ç®—ï¼Œè¿™é‡Œå°±ä¸å…·ä½“å±•å¼€äº†ï¼Œæ˜¯ `4^n / sqrt(n)`ã€‚

> æœ‰å…´è¶£å¯ä»¥æœç´¢ä¸€ä¸‹ã€Œå¡ç‰¹å…°æ•°ã€ç›¸å…³çš„çŸ¥è¯†äº†è§£ä¸€ä¸‹è¿™ä¸ªå¤æ‚åº¦æ˜¯æ€ä¹ˆç®—çš„ã€‚
